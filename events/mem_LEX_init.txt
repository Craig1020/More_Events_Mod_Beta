namespace = mem_lex_init

country_event = {
	id = mem_lex_init.1
	hide_window = yes
	
	#fire_only_once = yes
	
	trigger = {
		NOT = {
			AND = {
				has_global_flag = mem_ring_seed
				has_global_flag = mem_grave_seed
				has_global_flag = mem_garden_seed
				has_global_flag = mem_prison_seed
			}
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = {
					has_global_flag = mem_ring_lock
					any_system = {
						has_star_flag = mem_ring_system
					}
				}
			}
			random_system = {
				limit = {
					NOT = {
						OR = {
							has_star_flag = mem_grave_system
							has_star_flag = mem_garden_system
							has_star_flag = mem_prison_system
							has_star_flag = mem_system_spawn_2
							has_star_flag = mem_system_spawn_3
							has_star_flag = mem_system_spawn_4
						}
						is_fe_cluster = yes
					}
				}
				spawn_system = {
					min_distance = 20
					max_distance = 60
					initializer = "mem_ringworld"
				}
				set_star_flag = mem_system_spawn_1
			}
			set_global_flag = mem_ring_seed
		}
		if = {
			limit = {
				NOT = {
					has_global_flag = mem_grave_lock
					any_system = {
						has_star_flag = mem_grave_system
					}
				}
			}
			random_system = {
				limit = {
					NOT = {
						OR = {
							has_star_flag = mem_ring_system
							has_star_flag = mem_garden_system
							has_star_flag = mem_prison_system
							has_star_flag = mem_system_spawn_1
							has_star_flag = mem_system_spawn_3
							has_star_flag = mem_system_spawn_4
						}
						is_fe_cluster = yes
					}
				}
				spawn_system = {
					min_distance = 20
					max_distance = 60
					initializer = "mem_graveyard"
				}
				set_star_flag = mem_system_spawn_2
			}
			set_global_flag  = mem_grave_seed
		}
		if = {
			limit = {
				NOT = {
					has_global_flag = mem_garden_lock
					any_system = {
						has_star_flag = mem_garden_system
					}
				}
			}
			random_system = {
				limit = {
					NOT = {
						OR = {
							has_star_flag = mem_ring_system
							has_star_flag = mem_grave_system
							has_star_flag = mem_prison_system
							has_star_flag = mem_system_spawn_1
							has_star_flag = mem_system_spawn_2
							has_star_flag = mem_system_spawn_4
						}
						is_fe_cluster = yes
					}
				}
				spawn_system = {
					min_distance = 20
					max_distance = 60
					initializer = "mem_garden"
				}
				set_star_flag = mem_system_spawn_3
			}
			set_global_flag  = mem_garden_seed
		}
		if = {
			limit = {
				NOT = {
					has_global_flag = mem_prison_lock
					any_system = {
						has_star_flag = mem_prison_system
					}
				}
			}
			random_system = {
				limit = {
					NOT = {
						OR = {
							has_star_flag = mem_ring_system
							has_star_flag = mem_grave_system
							has_star_flag = mem_prison_system
							has_star_flag = mem_system_spawn_1
							has_star_flag = mem_system_spawn_2
							has_star_flag = mem_system_spawn_3
						}
						is_fe_cluster = yes
					}
				}
				spawn_system = {
					min_distance = 20
					max_distance = 60
					initializer = "mem_prison"
				}
				set_star_flag = mem_system_spawn_4
			}
			set_global_flag  = mem_prison_seed
		}
	}
}

country_event = {
	id = mem_lex_init.2
	hide_window = yes

	trigger = {
		is_ai = no
		is_country_type = default
		has_technology = "tech_sensors_4"
		NOT = {
			has_country_flag = mem_sensor_ping_lock
		}
	}
	
	mean_time_to_happen = {
		years = 5
	}

	immediate = {	
		set_country_flag = mem_sensor_ping_lock
		country_event = { id = mem_lex_init.3 days = 10 } 
	}
}

country_event = {
	id = mem_lex_init.3
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			AND = {
				has_country_flag = mem_ring_lock
				has_country_flag = mem_grave_lock
				has_country_flag = mem_garden_lock	
			}
		}
	}

	immediate = {
		random_list = {
			25 = {
				if = {
					limit = {
						NOT = {
							has_country_flag = mem_ring_lock
						}
					}
					set_country_flag = mem_ring_lock
					country_event = { id = mem_lex_init.4 days = 10 } 
					country_event = { id = mem_lex_init.3 days = 1800 }
					else = {
						country_event = { id = mem_lex_init.3 days = 1800 }
					}
				} 
			}
			25 = {
				if = {
					limit = {
						NOT = {
							has_country_flag = mem_grave_lock
						}
					}
					set_country_flag  = mem_grave_lock
					country_event = { id = mem_lex_init.5 days = 10 } 
					country_event = { id = mem_lex_init.3 days = 1800 }
					else = {
						country_event = { id = mem_lex_init.3 days = 1800 }
					}
				}
			}
			25 = {
				if = {
					limit = {
						NOT = {
							has_country_flag = mem_garden_lock
						}
					}
					set_country_flag  = mem_garden_lock
					country_event = { id = mem_lex_init.6 days = 10 } 
					country_event = { id = mem_lex_init.3 days = 1800 }
					else = {
						country_event = { id = mem_lex_init.3 days = 1800 }
					}
				}
			}
			25 = {
				if = {
					limit = {
						NOT = {
							has_country_flag = mem_prison_lock
						}
					}
					set_country_flag  = mem_prison_lock
					country_event = { id = mem_lex_init.7 days = 10 } 
					country_event = { id = mem_lex_init.3 days = 1800 }
					else = {
						country_event = { id = mem_lex_init.3 days = 1800 }
					}
				}
			}
		}
	}
}

# Ringworld

country_event = {
	id = mem_lex_init.4
	title = "mem_lex_init.4.name"
	desc = "mem_lex_init.4.desc"
	picture = GFX_evt_wormhole
	show_sound = event_sensor_ping
	
	is_triggered_only = yes
	
	trigger = {
		any_system = {
			has_star_flag = mem_ring_system
		}
		NOT = {
			has_event_chain = "mem_lex_ring_chain" 
			any_country = {
				has_country_flag = encountered_mem_titan
			}
		}
	}

	immediate = {
		random_system = {
			limit = {
				has_star_flag = mem_ring_system 
			}
			save_event_target_as = mem_ring_poi
		}
	}
	
	option = {
		name = "mem_lex_init.4.a"
		begin_event_chain = {
			event_chain = "mem_lex_ring_chain"
			target = ROOT
		}
		create_point_of_interest = {
			id = mem_lex_init_poi.1
			name = "mem_ring_guardian_poi"
			desc = "mem_ring_guardian_poi_desc"
			event_chain = mem_lex_ring_chain
			location = event_target:mem_ring_poi
		}
	}
}

# Graveyard

country_event = {
	id = mem_lex_init.5
	title = "mem_lex_init.5.name"
	desc = "mem_lex_init.5.desc"
	picture = GFX_evt_wormhole
	show_sound = event_sensor_ping
	
	is_triggered_only = yes
	
	trigger = {
		any_system = {
			has_star_flag = mem_grave_system
		}
		NOT = {
			has_event_chain = "mem_lex_grave_chain"
			any_country = {
				has_country_flag = encountered_mem_grave
			}
		}
		
	}

	immediate = {
		random_system = {
			limit = {
				has_star_flag = mem_grave_system 
			}
			save_event_target_as = mem_grave_poi
		}
	}
	
	option = {
		name = "mem_lex_init.5.a"
		begin_event_chain = {
			event_chain = "mem_lex_grave_chain"
			target = ROOT
		}
		create_point_of_interest = {
			id = mem_lex_init_poi.2
			name = "mem_grave_guardian_poi"
			desc = "mem_grave_guardian_poi_desc"
			event_chain = mem_lex_grave_chain
			location = event_target:mem_grave_poi
		}
	}
}

# Arcadia

country_event = {
	id = mem_lex_init.6
	title = "mem_lex_init.6.name"
	desc = "mem_lex_init.6.desc"
	picture = GFX_evt_wormhole
	show_sound = event_sensor_ping
	
	is_triggered_only = yes
	
	trigger = {
		any_system = {
			has_star_flag = mem_garden_system
		}
		NOT = {
			has_event_chain = "mem_lex_garden_chain" 
			any_country = {
				has_country_flag = encountered_mem_conduit
			}
		}
	}

	immediate = {
		random_system = {
			limit = {
				has_star_flag = mem_garden_system 
			}
			save_event_target_as = mem_garden_poi
		}
	}
	
	option = {
		name = "mem_lex_init.6.a"
		begin_event_chain = {
			event_chain = "mem_lex_garden_chain"
			target = ROOT
		}
		create_point_of_interest = {
			id = mem_lex_init_poi.3
			name = "mem_garden_guardian_poi"
			desc = "mem_garden_guardian_poi_desc"
			event_chain = mem_lex_garden_chain
			location = event_target:mem_garden_poi
		}
	}
}

# Vanth

country_event = {
	id = mem_lex_init.7
	title = "mem_lex_init.7.name"
	desc = "mem_lex_init.7.desc"
	picture = GFX_evt_wormhole
	show_sound = event_sensor_ping
	
	is_triggered_only = yes
	
	trigger = {
		any_system = {
			has_star_flag = mem_prison_system
		}
		NOT = {
			has_event_chain = "mem_lex_prison_chain" 
			any_country = {
				has_country_flag = encountered_mem_prison
			}
		}
	}

	immediate = {
		random_system = {
			limit = {
				has_star_flag = mem_prison_system
			}
			save_event_target_as = mem_prison_poi
		}
	}
	
	option = {
		name = "mem_lex_init.7.a"
		begin_event_chain = {
			event_chain = "mem_lex_prison_chain"
			target = ROOT
		}
		create_point_of_interest = {
			id = mem_lex_init_poi.4
			name = "mem_prison_guardian_poi"
			desc = "mem_prison_guardian_poi_desc"
			event_chain = mem_lex_prison_chain
			location = event_target:mem_prison_poi
		}
	}
}